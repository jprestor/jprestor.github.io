const path=require("path"),extension=require("./lib/extension"),normalize=require("./lib/normalize"),register=require("./lib/register");exports.prepare=function(e,t,r,n){var i,a,s,o=[],u=!1,l=extension(t);if(-1!==Object.keys(require.extensions).indexOf(l))return!0;var c=normalize(e[l]);if(!c){if(n)return;throw new Error('No module loader found for "'+l+'".')}r||(r=path.dirname(path.resolve(t))),Array.isArray(c)||(c=[c]);for(var f in c){if(i=c[f],a=register(r,i.module,i.register),error=a instanceof Error?a:null,error&&(a=null),o.push({moduleName:i.module,module:a,error:error}),!error){u=!1;break}u=!0}if(u){if(s=new Error('Unable to use specified module loaders for "'+l+'".'),s.failures=o,n)return s;throw s}return o};