function parseConstructorArguments(e){var t,r,n,i,a;if(mod_assertplus.object(e,"args"),mod_assertplus.bool(e.strict,"args.strict"),mod_assertplus.array(e.argv,"args.argv"),t=e.argv,0===t.length)r={},n=[];else if(mod_isError(t[0]))r={cause:t[0]},n=t.slice(1);else if("object"==typeof t[0]){r={};for(a in t[0])r[a]=t[0][a];n=t.slice(1)}else mod_assertplus.string(t[0],"first argument to VError, SError, or WError constructor must be a string, object, or Error"),r={},n=t;return mod_assertplus.object(r),r.strict||e.strict||(n=n.map(function(e){return null===e?"null":void 0===e?"undefined":e})),i=0===n.length?"":sprintf.apply(null,n),{options:r,shortmessage:i}}function VError(){var e,t,r,n,i,a,o;if(e=Array.prototype.slice.call(arguments,0),!(this instanceof VError))return t=Object.create(VError.prototype),VError.apply(t,arguments),t;if(r=parseConstructorArguments({argv:e,strict:!1}),r.options.name&&(mod_assertplus.string(r.options.name,'error\'s "name" must be a string'),this.name=r.options.name),this.jse_shortmsg=r.shortmessage,a=r.shortmessage,n=r.options.cause,n&&(mod_assertplus.ok(mod_isError(n),"cause is not an Error"),this.jse_cause=n,r.options.skipCauseMessage||(a+=": "+n.message)),this.jse_info={},r.options.info)for(o in r.options.info)this.jse_info[o]=r.options.info[o];return this.message=a,Error.call(this,a),Error.captureStackTrace&&(i=r.options.constructorOpt||this.constructor,Error.captureStackTrace(this,i)),this}function SError(){var e,t,r,n;return e=Array.prototype.slice.call(arguments,0),this instanceof SError?(r=parseConstructorArguments({argv:e,strict:!0}),n=r.options,VError.call(this,n,"%s",r.shortmessage),this):(t=Object.create(SError.prototype),SError.apply(t,arguments),t)}function MultiError(e){mod_assertplus.array(e,"list of errors"),mod_assertplus.ok(e.length>0,"must be at least one error"),this.ase_errors=e,VError.call(this,{cause:e[0]},"first of %d error%s",e.length,1==e.length?"":"s")}function WError(){var e,t,r,n;return e=Array.prototype.slice.call(arguments,0),this instanceof WError?(r=parseConstructorArguments({argv:e,strict:!1}),n=r.options,n.skipCauseMessage=!0,VError.call(this,n,"%s",r.shortmessage),this):(t=Object.create(WError.prototype),WError.apply(t,e),t)}var mod_assertplus=require("assert-plus"),mod_util=require("util"),mod_extsprintf=require("extsprintf"),mod_isError=require("core-util-is").isError,sprintf=mod_extsprintf.sprintf;module.exports=VError,VError.VError=VError,VError.SError=SError,VError.WError=WError,VError.MultiError=MultiError,mod_util.inherits(VError,Error),VError.prototype.name="VError",VError.prototype.toString=function(){var e=this.hasOwnProperty("name")&&this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(e+=": "+this.message),e},VError.prototype.cause=function(){var e=VError.cause(this);return null===e?void 0:e},VError.cause=function(e){return mod_assertplus.ok(mod_isError(e),"err must be an Error"),mod_isError(e.jse_cause)?e.jse_cause:null},VError.info=function(e){var t,r,n;if(mod_assertplus.ok(mod_isError(e),"err must be an Error"),r=VError.cause(e),t=null!==r?VError.info(r):{},"object"==typeof e.jse_info&&null!==e.jse_info)for(n in e.jse_info)t[n]=e.jse_info[n];return t},VError.findCauseByName=function(e,t){var r;for(mod_assertplus.ok(mod_isError(e),"err must be an Error"),mod_assertplus.string(t,"name"),mod_assertplus.ok(t.length>0,"name cannot be empty"),r=e;null!==r;r=VError.cause(r))if(mod_assertplus.ok(mod_isError(r)),r.name==t)return r;return null},VError.hasCauseWithName=function(e,t){return null!==VError.findCauseByName(e,t)},VError.fullStack=function(e){mod_assertplus.ok(mod_isError(e),"err must be an Error");var t=VError.cause(e);return t?e.stack+"\ncaused by: "+VError.fullStack(t):e.stack},VError.errorFromList=function(e){return mod_assertplus.arrayOfObject(e,"errors"),0===e.length?null:(e.forEach(function(e){mod_assertplus.ok(mod_isError(e))}),1==e.length?e[0]:new MultiError(e))},VError.errorForEach=function(e,t){mod_assertplus.ok(mod_isError(e),"err must be an Error"),mod_assertplus.func(t,"func"),e instanceof MultiError?e.errors().forEach(function(e){t(e)}):t(e)},mod_util.inherits(SError,VError),mod_util.inherits(MultiError,VError),MultiError.prototype.name="MultiError",MultiError.prototype.errors=function(){return this.ase_errors.slice(0)},mod_util.inherits(WError,VError),WError.prototype.name="WError",WError.prototype.toString=function(){var e=this.hasOwnProperty("name")&&this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(e+=": "+this.message),this.jse_cause&&this.jse_cause.message&&(e+="; caused by "+this.jse_cause.toString()),e},WError.prototype.cause=function(e){return mod_isError(e)&&(this.jse_cause=e),this.jse_cause};