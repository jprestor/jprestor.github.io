function read(e,t){if("string"==typeof e){if(e.trim().match(/^[-]+[ ]*BEGIN/))return pem.read(e,t);if(e.match(/^\s*ssh-[a-z]/))return ssh.read(e,t);if(e.match(/^\s*ecdsa-/))return ssh.read(e,t);e=new Buffer(e,"binary")}else{if(assert.buffer(e),findPEMHeader(e))return pem.read(e,t);if(findSSHHeader(e))return ssh.read(e,t)}if(e.readUInt32BE(0)<e.length)return rfc4253.read(e,t);throw new Error("Failed to auto-detect format of key")}function findSSHHeader(e){for(var t=0;t<e.length&&(32===e[t]||10===e[t]||9===e[t]);)++t;return t+4<=e.length&&"ssh-"===e.slice(t,t+4).toString("ascii")?!0:t+6<=e.length&&"ecdsa-"===e.slice(t,t+6).toString("ascii")?!0:!1}function findPEMHeader(e){for(var t=0;t<e.length&&(32===e[t]||10===e[t]);)++t;if(45!==e[t])return!1;for(;t<e.length&&45===e[t];)++t;for(;t<e.length&&32===e[t];)++t;return t+5>e.length||"BEGIN"!==e.slice(t,t+5).toString("ascii")?!1:!0}function write(e,t){throw new Error('"auto" format cannot be used for writing')}module.exports={read:read,write:write};var assert=require("assert-plus"),utils=require("../utils"),Key=require("../key"),PrivateKey=require("../private-key"),pem=require("./pem"),ssh=require("./ssh"),rfc4253=require("./rfc4253");