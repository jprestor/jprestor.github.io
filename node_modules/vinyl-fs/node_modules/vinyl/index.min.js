function File(e){e||(e={});var t=e.path?[e.path]:e.history;this.history=t||[],this.cwd=e.cwd||process.cwd(),this.base=e.base||this.cwd,this.stat=e.stat||null,this.contents=e.contents||null}var path=require("path"),clone=require("clone"),cloneStats=require("clone-stats"),cloneBuffer=require("./lib/cloneBuffer"),isBuffer=require("./lib/isBuffer"),isStream=require("./lib/isStream"),isNull=require("./lib/isNull"),inspectStream=require("./lib/inspectStream"),Stream=require("stream");File.prototype.isBuffer=function(){return isBuffer(this.contents)},File.prototype.isStream=function(){return isStream(this.contents)},File.prototype.isNull=function(){return isNull(this.contents)},File.prototype.isDirectory=function(){return this.isNull()&&this.stat&&this.stat.isDirectory()},File.prototype.clone=function(e){"boolean"==typeof e?e={deep:e,contents:!0}:e?(e.deep=e.deep===!0,e.contents=e.contents!==!1):e={deep:!1,contents:!0};var t;this.isStream()?(t=this.contents.pipe(new Stream.PassThrough),this.contents=this.contents.pipe(new Stream.PassThrough)):this.isBuffer()&&(t=e.contents?cloneBuffer(this.contents):this.contents);var r=new File({cwd:this.cwd,base:this.base,stat:this.stat?cloneStats(this.stat):null,history:this.history.slice(),contents:t});return Object.keys(this).forEach(function(t){"_contents"!==t&&"stat"!==t&&"history"!==t&&"path"!==t&&"base"!==t&&"cwd"!==t&&(r[t]=e.deep?clone(this[t],!0):this[t])},this),r},File.prototype.pipe=function(e,t){return t||(t={}),"undefined"==typeof t.end&&(t.end=!0),this.isStream()?this.contents.pipe(e,t):this.isBuffer()?(t.end?e.end(this.contents):e.write(this.contents),e):(t.end&&e.end(),e)},File.prototype.inspect=function(){var e=[],t=this.base&&this.path?this.relative:this.path;return t&&e.push('"'+t+'"'),this.isBuffer()&&e.push(this.contents.inspect()),this.isStream()&&e.push(inspectStream(this.contents)),"<File "+e.join(" ")+">"},Object.defineProperty(File.prototype,"contents",{get:function(){return this._contents},set:function(e){if(!isBuffer(e)&&!isStream(e)&&!isNull(e))throw new Error("File.contents can only be a Buffer, a Stream, or null.");this._contents=e}}),Object.defineProperty(File.prototype,"relative",{get:function(){if(!this.base)throw new Error("No base specified! Can not get relative.");if(!this.path)throw new Error("No path specified! Can not get relative.");return path.relative(this.base,this.path)},set:function(){throw new Error("File.relative is generated from the base and path attributes. Do not modify it.")}}),Object.defineProperty(File.prototype,"path",{get:function(){return this.history[this.history.length-1]},set:function(e){if("string"!=typeof e)throw new Error("path should be string");e&&e!==this.path&&this.history.push(e)}}),module.exports=File;