function Argv(e,t){function m(e){var t=Parser(e,o),s=t.argv,u=t.aliases;s.$0=r.$0,r.parsed=t,d&&~s._.indexOf(d)&&(r.showCompletionScript(),p&&process.exit(0));for(var y,m=Object.keys(r.getCommandHandlers()),g=0;void 0!==(y=m[g]);g++)if(~s._.indexOf(y))return r.getCommandHandlers()[y](r.reset()),r.argv;return Object.keys(s).forEach(function(e){if(e===f&&s[e])r.showHelp("log"),p&&process.exit(0);else if(e===c&&s[e])i.showVersion(),p&&process.exit(0);else if(e===h)return void n.getCompletion(function(e){(e||[]).forEach(function(e){console.log(e)}),p&&process.exit(0)})}),a.nonOptionCount(s),a.missingArgumentValue(s),a.requiredArguments(s),l&&a.unknownArguments(s,u),a.customChecks(s,u),a.implications(s),v(s),s}function v(e){Object.keys(o.key).forEach(function(t){"undefined"==typeof e[t]&&(e[t]=void 0)})}e=e||[];var r={},n=null,i=null,a=null;t||(t=process.cwd()),r.$0=process.argv.slice(0,2).map(function(e,r){if(0!==r||!/\b(node|iojs)$/.test(e)){var n=rebase(t,e);return e.match(/^\//)&&n.length<e.length?n:e}}).join(" ").trim(),void 0!==process.env._&&process.argv[1]===process.env._&&(r.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var o;r.resetOptions=r.reset=function(){return o={array:[],"boolean":[],string:[],narg:{},key:{},alias:{},"default":{},defaultDescription:{},requiresArg:[],count:[],normalize:[],config:[]},i=Usage(r),a=Validation(r,i),n=Completion(r,i),u={},p=!0,l=!1,f=null,c=null,h=null,s={},r.parsed=!1,r},r.resetOptions(),r["boolean"]=function(e){return o["boolean"].push.apply(o["boolean"],[].concat(e)),r},r.array=function(e){return o.array.push.apply(o.array,[].concat(e)),r},r.nargs=function(e,t){return"object"==typeof e?Object.keys(e).forEach(function(t){r.nargs(t,e[t])}):o.narg[e]=t,r},r.normalize=function(e){return o.normalize.push.apply(o.normalize,[].concat(e)),r},r.config=function(e){return o.config.push.apply(o.config,[].concat(e)),r},r.example=function(e,t){return i.example(e,t),r},r.command=function(e,t,n){return i.command(e,t),n&&(s[e]=n),r};var s={};r.getCommandHandlers=function(){return s},r.string=function(e){return o.string.push.apply(o.string,[].concat(e)),r},r["default"]=function(e,t,n){return"object"==typeof e?Object.keys(e).forEach(function(t){r["default"](t,e[t])}):("function"==typeof t&&(n=i.functionDescription(t,n),t=t.call()),o.defaultDescription[e]=n,o["default"][e]=t),r},r.alias=function(e,t){return"object"==typeof e?Object.keys(e).forEach(function(t){r.alias(t,e[t])}):o.alias[e]=(o.alias[e]||[]).concat(t),r},r.count=function(e){return o.count.push.apply(o.count,[].concat(e)),r};var u={};r.demand=r.required=r.require=function(e,t){return"number"==typeof e?(u._||(u._={count:0,msg:null}),u._.count+=e,u._.msg=t):Array.isArray(e)?e.forEach(function(e){r.demand(e,t)}):"string"==typeof t?u[e]={msg:t}:(t===!0||"undefined"==typeof t)&&(u[e]={msg:void 0}),r},r.getDemanded=function(){return u},r.requiresArg=function(e){return o.requiresArg.push.apply(o.requiresArg,[].concat(e)),r},r.implies=function(e,t){return a.implies(e,t),r},r.usage=function(e,t){return t||"object"!=typeof e||(t=e,e=null),i.usage(e),t&&r.options(t),r},r.epilogue=r.epilog=function(e){return i.epilog(e),r},r.fail=function(e){return i.failFn(e),r},r.check=function(e){return a.check(e),r},r.defaults=r["default"],r.describe=function(e,t){return o.key[e]=!0,i.describe(e,t),r},r.parse=function(e){return m(e)},r.option=r.options=function(e,t){if("object"==typeof e)Object.keys(e).forEach(function(t){r.options(t,e[t])});else{assert("object"==typeof t,"second argument to option must be an object"),o.key[e]=!0,t.alias&&r.alias(e,t.alias);var n=t.demand||t.required||t.require;n&&r.demand(e,n),"default"in t&&r["default"](e,t["default"]),"nargs"in t&&r.nargs(e,t.nargs),(t["boolean"]||"boolean"===t.type)&&(r["boolean"](e),t.alias&&r["boolean"](t.alias)),(t.array||"array"===t.type)&&(r.array(e),t.alias&&r.array(t.alias)),(t.string||"string"===t.type)&&(r.string(e),t.alias&&r.string(t.alias)),(t.count||"count"===t.type)&&r.count(e);var i=t.describe||t.description||t.desc;i&&r.describe(e,i),t.requiresArg&&r.requiresArg(e)}return r},r.getOptions=function(){return o},r.wrap=function(e){return i.wrap(e),r};var l=!1;r.strict=function(){return l=!0,r},r.getStrict=function(){return l},r.showHelp=function(t){return r.parsed||m(e),i.showHelp(t),r};var c=null;r.version=function(e,t,n){return c=t||"version",i.version(e),r["boolean"](c),r.describe(c,n||"Show version number"),r};var f=null;r.addHelpOpt=function(e,t){return f=e,r["boolean"](e),r.describe(e,t||"Show help"),r},r.showHelpOnFail=function(e,t){return i.showHelpOnFail(e,t),r};var p=!0;r.exitProcess=function(e){return"boolean"!=typeof e&&(e=!0),p=e,r},r.getExitProcess=function(){return p},r.help=function(){return arguments.length>0?r.addHelpOpt.apply(r,arguments):(r.parsed||m(e),i.help())};var h=null,d=null;return r.completion=function(e,t,i){return"function"==typeof t&&(i=t,t=null),d=e,h=n.completionKey,r.command(d,t||"generate bash completion script"),i&&n.registerFunction(i),r},r.showCompletionScript=function(e){return e=e||r.$0,console.log(n.generateCompletionScript(e)),r},r.getUsageInstance=function(){return i},r.getValidationInstance=function(){return a},r.terminalWidth=function(){return require("window-size").width},Object.defineProperty(r,"argv",{get:function(){var t=null;try{t=m(e)}catch(r){i.fail(r.message)}return t},enumerable:!0}),sigletonify(r),r}function rebase(e,t){return path.relative(e,t)}function sigletonify(e){Object.keys(e).forEach(function(t){"argv"===t?Argv.__defineGetter__(t,e.__lookupGetter__(t)):Argv[t]="function"==typeof e[t]?e[t].bind(e):e[t]})}var assert=require("assert"),path=require("path"),Completion=require("./lib/completion"),Parser=require("./lib/parser"),Usage=require("./lib/usage"),Validation=require("./lib/validation");Argv(process.argv.slice(2));var exports=module.exports=Argv;exports.rebase=rebase;