!function(e){"use strict";e(function(e){function i(e){function l(e,t,r){this[e]=t,0===--o&&r.resolve(i)}for(var u,t=r._defer(),n=r._handler(t),i={},a=Object.keys(e),o=a.length,s=0;s<a.length;++s)u=a[s],r._handler(e[u]).fold(l,u,i,n);return 0===o&&n.resolve(i),t}function a(e,t){function r(e,r){return t(r,e)}return n(e).then(function(e){return i(Object.keys(e).reduce(function(t,i){return t[i]=n(e[i]).fold(r,i),t},{}))})}function o(e){var i=Object.keys(e),a={};if(0===i.length)return n(a);var o=r._defer(),u=r._handler(o),l=i.map(function(t){return e[t]});return t.settle(l).then(function(e){s(i,e,a,u)}),o}function s(e,t,r,n){for(var i=0;i<e.length;i++)r[e[i]]=t[i];n.resolve(r)}var t=e("./when"),r=t.Promise,n=t.resolve;return{all:t.lift(i),map:a,settle:o}})}("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)});