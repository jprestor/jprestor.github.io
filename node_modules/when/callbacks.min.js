!function(e){e(function(e){function s(e,t){return o(e,this,t||[])}function u(e,t,r,n){r.push(g(n.resolve,n),g(n.reject,n)),l(e,t,r,n)}function l(e,t,r,n){try{e.apply(t,r)}catch(i){n.reject(i)}}function c(e){return o(e,this,i.call(arguments,1))}function f(e){var t=arguments.length>1?i.call(arguments,1):[];return function(){return o(e,this,t.concat(i.call(arguments)))}}function p(e,t,r){return n(f,t,r,e)}function h(e,t){return function(){var n=this;return r.all(arguments).then(function(i){var o,s,a=r._defer();return"number"==typeof t.callback&&(o=d(i,t.callback)),"number"==typeof t.errback&&(s=d(i,t.errback)),o>s?(m(i,s,a._handler.reject,a._handler),m(i,o,a._handler.resolve,a._handler)):(m(i,o,a._handler.resolve,a._handler),m(i,s,a._handler.reject,a._handler)),e.apply(n,i),a})}}function d(e,t){return 0>t?e.length+t+2:t}function m(e,t,r,n){"number"==typeof t&&e.splice(t,0,g(r,n))}function g(e,t){return function(){arguments.length>1?e.call(t,i.call(arguments)):e.apply(t,arguments)}}var t=e("./when"),r=t.Promise,n=e("./lib/liftAll"),i=Array.prototype.slice,a=e("./lib/apply"),o=a(r,u);return{lift:f,liftAll:p,apply:s,call:c,promisify:h}})}("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)});