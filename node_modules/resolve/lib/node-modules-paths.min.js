var path=require("path"),fs=require("fs"),parse=path.parse||require("path-parse");module.exports=function(e,t){var r=t&&t.moduleDirectory?[].concat(t.moduleDirectory):["node_modules"],n=path.resolve(e);if(t&&t.preserveSymlinks===!1)try{n=fs.realpathSync(n)}catch(i){if("ENOENT"!==i.code)throw i}var a="/";/^([A-Za-z]:)/.test(n)?a="":/^\\\\/.test(n)&&(a="\\\\");for(var o=[n],s=parse(n);s.dir!==o[o.length-1];)o.push(s.dir),s=parse(s.dir);var u=o.reduce(function(e,t){return e.concat(r.map(function(e){return path.join(a,t,e)}))},[]);return t&&t.paths?u.concat(t.paths):u};